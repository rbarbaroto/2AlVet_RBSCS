#no código, as variaveis que começam com A significam @
import csv
import requests
from datetime import datetime, timedelta
import time
import os
import pyodbc


# Substitua 'API_KEY' pelo seu token de API do Bling
API_KEY = 'b3ad0499b513779c9adde78cecbad774669e8a80a6feaacada87f5ac969b7e8bc5f935cd'

# URL da API para buscar os pedidos
url = f'https://bling.com.br/Api/v2/pedidos/json'




# Configurações de conexão com o banco de dados
server = 'DESKTOP-RB\SQLEXPRESS'
database = 'DualVet'
driver = '{ODBC Driver 17 for SQL Server}'  # Driver ODBC para SQL Server




# Lista para armazenar os pedidos já processados
processed_orders = []

path_logs = 'F:/Projetos/DualVet - Lucas/T4/Pedidos/Logs'
path_data = 'F:/Projetos/DualVet - Lucas/T4/Pedidos/Data'




#Variaveis da saída das querys
status = ""
encontrado_ou_nao = ""
Anumerocpfcnpj = ""
Aidcpfcnpj = ""


#Variaveis Query2
status2 = ""
ANumeroID2 = ""
Anumerocpfcnpj2 = ""
ACodigoRetorno2 = ""
Aresposta2 = ""

# Defina a função execute_sql_query para executar a primeira query - Query Clientes_Pedidos-Consulta
def execute_sql_query(query1):
    global status
    global encontrado_ou_nao
    global Anumerocpfcnpj
    global Aidcpfcnpj
    global valores_separados

    try:
        # Estabelece a conexão com o banco de dados usando autenticação do Windows
        conn = pyodbc.connect(f'DRIVER={driver};SERVER={server};DATABASE={database};Trusted_Connection=yes')

        cursor = conn.cursor()

        # Executa a query
        cursor.execute(query1)

        # Obtém o resultado da query
        row = cursor.fetchone()

        if row:
            result = row[0]  # Obtém o primeiro valor da linha retornada
            #print("Resultado da Query1 SQL:", result)
            valores_separados = result.split('|')
            #status, encontrado_ou_nao, Anumerocpfcnpj, Aidcpfcnpj = valores_separados
            status = valores_separados[0]
            encontrado_ou_nao = valores_separados[1]
            Anumerocpfcnpj = valores_separados[2]
            if len(valores_separados) > 3:
                Aidcpfcnpj = valores_separados[3]

            
        else:
            print("Nenhum resultado encontrado para a query.")


        # Confirma a transação
        conn.commit()

        # Fecha a conexão
        conn.close()

        print("Query Consulta: ", result)

        path_logsql = "F:/Projetos/DualVet - Lucas/T4/Pedidos/Querys/"
        nome_arquivo_log = f"{path_logsql}Pedido-{numero}_Query_Consulta.log"
        
        # Abre o arquivo de log em modo de anexação e grava a consulta
        with open(nome_arquivo_log, "a") as arquivo_log:
            arquivo_log.write(f"Consulta do Pedido {numero}:\n{query1}\n\n")
            arquivo_log.write(f"{result}")



    except Exception as e:
        print(f"Erro ao executar a query SQL1: {str(e)}")


#spParceirosAdd
def execute_sql_query2(query2):
    global status2
    global ANumeroID2
    global Anumerocpfcnpj2
    global ACodigoRetorno2
    global Aresposta2


    try:
        # Estabelece a conexão com o banco de dados usando autenticação do Windows
        conn = pyodbc.connect(f'DRIVER={driver};SERVER={server};DATABASE={database};Trusted_Connection=yes')

        cursor = conn.cursor()

        # Executa a query
        cursor.execute(query2)


        # Obtém o resultado da query
        while cursor.nextset():
            try:
                results2 = cursor.fetchall()
                # Iterar sobre as tuplas e imprimir apenas a string dentro delas
                for resultado2 in results2:
                    print("Query spParceirosAdd:", resultado2[0])

                    valores_separados2 = resultado2[0].split(',')
                    #status, encontrado_ou_nao, Anumerocpfcnpj, Aidcpfcnpj = valores_separados
                    #print(valores_separados2)
                    if len(valores_separados2) >=3:
                        status2 = valores_separados2[0]
                        ANumeroID2 = valores_separados2[2]
                        Anumerocpfcnpj2 = valores_separados2[1]
                        ACodigoRetorno2 = valores_separados2[3]
                        #if len(valores_separados2) > 3:
                        Aresposta2 = valores_separados2[4]
                        

                break
            except pyodbc.ProgrammingError:
                continue


        # Confirma a transação
        conn.commit()

        # Fecha a conexão
        conn.close()

        path_logsql = "F:/Projetos/DualVet - Lucas/T4/Pedidos/Querys/"
        nome_arquivo_log = f"{path_logsql}Pedido-{numero}_Query_spParceirosAdd.log"
        
        # Abre o arquivo de log em modo de anexação e grava a consulta
        with open(nome_arquivo_log, "a") as arquivo_log:
            arquivo_log.write(f"Query_spParceirosAdd {numero}:\n{query2}\n\n")
            arquivo_log.write(f"{results2}")

        #print("Query SQL2 executada com sucesso no banco de dados.")
    except Exception as e:
        print(f"Erro ao executar a query SQL2: {str(e)}")


#spParceirosEdit
def execute_sql_query3(query3):
    

    try:
        # Estabelece a conexão com o banco de dados usando autenticação do Windows
        conn = pyodbc.connect(f'DRIVER={driver};SERVER={server};DATABASE={database};Trusted_Connection=yes')

        cursor = conn.cursor()

        # Executa a query
        cursor.execute(query3)

        # Obtém o resultado da query
        while cursor.nextset():
            try:
                results3 = cursor.fetchall()
                # Iterar sobre as tuplas e imprimir apenas a string dentro delas
                for resultado3 in results3:
                    print("Query spParceirosEdit:", resultado3[0])
                break
            except pyodbc.ProgrammingError:
                continue



        # Confirma a transação
        conn.commit()

        # Fecha a conexão
        conn.close()


        path_logsql = "F:/Projetos/DualVet - Lucas/T4/Pedidos/Querys/"
        nome_arquivo_log = f"{path_logsql}Pedido-{numero}_Query_spParceirosEdit.log"
        
        # Abre o arquivo de log em modo de anexação e grava a consulta
        with open(nome_arquivo_log, "a") as arquivo_log:
            arquivo_log.write(f"Query_spParceirosEdit {numero}:\n{query3}\n\n")
            arquivo_log.write(f"{results3}")

        print("Query SQL spParceirosEdit executada com sucesso no banco de dados.")
    except Exception as e:
        print(f"Erro ao executar a query3 SQL: {str(e)}")


#spParceirosClientesAdd
def execute_sql_query4(query4):
    

    try:
        # Estabelece a conexão com o banco de dados usando autenticação do Windows
        conn = pyodbc.connect(f'DRIVER={driver};SERVER={server};DATABASE={database};Trusted_Connection=yes')

        cursor = conn.cursor()

        # Executa a query
        cursor.execute(query4)

        # Obtém o resultado da query
        while cursor.nextset():
            try:
                results4 = cursor.fetchall()
                # Iterar sobre as tuplas e imprimir apenas a string dentro delas
                for resultado4 in results4:
                    print("Query spParceirosClientesAdd:", resultado4[0])
                break
            except pyodbc.ProgrammingError:
                continue



        # Confirma a transação
        conn.commit()

        # Fecha a conexão
        conn.close()

        path_logsql = "F:/Projetos/DualVet - Lucas/T4/Pedidos/Querys/"
        nome_arquivo_log = f"{path_logsql}Pedido-{numero}_Query_spParceirosClientesAdd.log"
        
        # Abre o arquivo de log em modo de anexação e grava a consulta
        with open(nome_arquivo_log, "a") as arquivo_log:
            arquivo_log.write(f"Query_spParceirosClientesAdd {numero}:\n{query4}\n\n")
            arquivo_log.write(f"{results4}")


        print("Query4 SQL executada com sucesso no banco de dados.")
        print()
    except Exception as e:
        print(f"Erro ao executar a query4 SQL: {str(e)}")


#spPedidosAdd
def execute_sql_query5(query5):
    

    try:
        # Estabelece a conexão com o banco de dados usando autenticação do Windows
        conn = pyodbc.connect(f'DRIVER={driver};SERVER={server};DATABASE={database};Trusted_Connection=yes')

        cursor = conn.cursor()

        # Executa a query
        cursor.execute(query5)

        results5 = cursor.fetchall()

        for resultado5 in results5:
            print("Query spPedidosAdd: ", resultado5[0])

       
       # Obtém o resultado da query
        #while cursor.nextset():
            #try:
                #results5 = cursor.fetchall()
                # Iterar sobre as tuplas e imprimir apenas a string dentro delas
                #for resultado5 in results5:
                #    print("Query spPedidosAdd:", resultado5[0])
                #break
            #except pyodbc.ProgrammingError:
                #continue
    


        # Confirma a transação
        conn.commit()

        # Fecha a conexão
        conn.close()

        path_logsql = "F:/Projetos/DualVet - Lucas/T4/Pedidos/Querys/"
        nome_arquivo_log = f"{path_logsql}Pedido-{numero}_Query_spPedidosAdd.log"
        
        # Abre o arquivo de log em modo de anexação e grava a consulta
        with open(nome_arquivo_log, "a") as arquivo_log:
            arquivo_log.write(f"Query_spPedidosAdd {numero}:\n{query5}\n\n")
            arquivo_log.write(f"{resultado5}")


        print("Query SQL5 executada com sucesso no banco de dados.")
        print()
    except Exception as e:
        print(f"Erro ao executar a query5 SQL: {str(e)}")



# Inicie o loop while
while True:
    try:
        # Formatação da data para o formato esperado pela API do Bling (dd/mm/yyyy)
        today_date = datetime.now().strftime("%d/%m/%Y")

        # Parâmetros da consulta
        params = {
            'apikey': API_KEY,
            'filters': f'dataEmissao[{today_date} TO {today_date}]'  # Filtrando pedidos do dia atual
        }

        # Fazendo a solicitação GET
        response = requests.get(url, params=params)

        # Verificando se a solicitação foi bem sucedida
        if response.status_code == 200:
            # Convertendo a resposta para JSON
            data = response.json()

            # Verificando se há pedidos
            if 'pedidos' in data['retorno']:
                pedidos = data['retorno']['pedidos']

                # Verificando se há novos pedidos desde a última verificação
                new_orders = [pedido for pedido in pedidos if pedido['pedido']['numero'] not in processed_orders]

                if new_orders:
                    for pedido in new_orders:
                        # Processar o pedido e salvar no banco de dados, CSV e log
                        dados_pedido = pedido['pedido']

                        tipointegracao = dados_pedido['tipoIntegracao']
                        
                        numero = dados_pedido['numero']
                        data_emissao = dados_pedido['data']
                        cliente = dados_pedido['cliente']['nome']
                        cnpj = dados_pedido['cliente']['cnpj']
                        valor_total = dados_pedido['totalvenda'].replace('.', ',')  # Substituindo ponto por vírgula

                        desconto = dados_pedido['desconto']
                        outras_despesas = dados_pedido['outrasdespesas']
                        situacao = dados_pedido['situacao']
                        data_saida = dados_pedido['dataSaida']
                        loja = dados_pedido['loja']
                        tipo_integracao = dados_pedido['tipoIntegracao']
                        data_prevista = dados_pedido.get('dataPrevista', '')  # Usando .get() para evitar KeyError

                        nome_cliente = dados_pedido['cliente']['nome']
                        endereco_cliente = dados_pedido['cliente']['endereco']
                        numero_cliente = dados_pedido['cliente']['numero']
                        email_cliente = dados_pedido['cliente']['email']
                        complemento_cliente = dados_pedido['cliente']['complemento']
                        cidade_cliente = dados_pedido['cliente']['cidade']
                        bairro_cliente = dados_pedido['cliente']['bairro']
                        cep_cliente = dados_pedido['cliente']['cep']
                        uf_cliente = dados_pedido['cliente']['uf']
                        fone_cliente = dados_pedido['cliente']['fone']

                        tipo_frete = dados_pedido['transporte']['tipo_frete']
                        qtde_volumes = dados_pedido['transporte']['qtde_volumes']
                        peso_bruto = dados_pedido['transporte']['peso_bruto']
                        servico_transporte = dados_pedido['transporte'].get('servico_correios', '')  # Usando .get() para evitar KeyError

                        for item in dados_pedido['itens']:
                            codigo_produto = item['item']['codigo']
                            descricao_produto = item['item']['descricao']
                            quantidade_produto = item['item']['quantidade'].replace('.', ',')
                            valor_unitario_produto = item['item']['valorunidade'].replace('.', ',')
                            preco_custo_produto = item['item']['precocusto']
                            desconto_item = item['item']['descontoItem']
                            unidade_produto = item['item']['un']
                            peso_bruto_produto = item['item']['pesoBruto']
                            largura_produto = item['item']['largura']
                            altura_produto = item['item']['altura']
                            profundidade_produto = item['item']['profundidade']

                        # Nome do arquivo CSV
                        csv_file = os.path.join(path_data,f'Pedido_{numero}_{datetime.now().strftime("%d-%m-%Y_%H-%M")}.csv')

                        # Nome do arquivo de log
                        log_file = os.path.join(path_logs,f'Log_{numero}_{datetime.now().strftime("%d-%m-%Y_%H-%M")}.txt')

                        # Abrindo o arquivo CSV para escrita
                        with open(csv_file, mode='w', newline='', encoding='utf-8-sig') as file:
                            writer = csv.writer(file)

                            # Escrevendo cabeçalho do CSV
                            writer.writerow([
                                'Numero', 'Data', 'Cliente', 'CNPJ', 'Valor Total', 'Desconto', 'Outras Despesas',
                                'Situacao', 'Data de Saída', 'Loja', 'Tipo de Integração', 'Data Prevista',
                                'Nome do Cliente', 'Endereco do Cliente', 'Numero do Cliente', 'Complemento do Cliente',
                                'Cidade do Cliente', 'Bairro do Cliente', 'CEP do Cliente', 'UF do Cliente',
                                'Tipo de Frete', 'Quantidade de Volumes', 'Peso Bruto', 'Serviço de Transporte',
                                'Código do Produto', 'Descrição do Produto', 'Quantidade do Produto', 'Valor Unitário do Produto',
                                'Preço de Custo do Produto', 'Desconto do Item', 'Unidade do Produto', 'Peso Bruto do Produto',
                                'Largura do Produto', 'Altura do Produto', 'Profundidade do Produto'
                            ])

                            # Escrevendo os dados do novo pedido no arquivo CSV
                            writer.writerow([
                                numero, data_emissao, cliente, cnpj, valor_total, desconto, outras_despesas,
                                situacao, data_saida, loja, tipo_integracao, data_prevista, nome_cliente,
                                endereco_cliente, numero_cliente, complemento_cliente, cidade_cliente, bairro_cliente,
                                cep_cliente, uf_cliente, tipo_frete, qtde_volumes, peso_bruto, servico_transporte,
                                codigo_produto, descricao_produto, quantidade_produto, valor_unitario_produto,
                                preco_custo_produto, desconto_item, unidade_produto, peso_bruto_produto,
                                largura_produto, altura_produto, profundidade_produto
                            ])

                        # Abrindo o arquivo de log para escrita
                        with open(log_file, mode='w', encoding='utf-8') as log:
                            # Escrevendo os dados do novo pedido no arquivo de log
                            log.write(f'Número do Pedido: {numero}\n')
                            log.write(f'Data de Emissão: {data_emissao}\n')
                            log.write(f'Cliente: {cliente}\n')
                            log.write(f'Valor Total: {valor_total}\n')
                            log.write(f'Desconto: {desconto}\n')
                            log.write(f'Outras Despesas: {outras_despesas}\n')
                            log.write(f'Situação: {situacao}\n')
                            log.write(f'Data de Saída: {data_saida}\n')
                            log.write(f'Loja: {loja}\n')
                            log.write(f'Tipo de Integração: {tipo_integracao}\n')
                            log.write(f'Data Prevista: {data_prevista}\n')
                            log.write(f'Nome do Cliente: {nome_cliente}\n')
                            log.write(f'Endereço do Cliente: {endereco_cliente}\n')
                            log.write(f'Número do Cliente: {numero_cliente}\n')
                            log.write(f'Complemento do Cliente: {complemento_cliente}\n')
                            log.write(f'Cidade do Cliente: {cidade_cliente}\n')
                            log.write(f'Bairro do Cliente: {bairro_cliente}\n')
                            log.write(f'CEP do Cliente: {cep_cliente}\n')
                            log.write(f'UF do Cliente: {uf_cliente}\n')
                            log.write(f'Tipo de Frete: {tipo_frete}\n')
                            log.write(f'Quantidade de Volumes: {qtde_volumes}\n')
                            log.write(f'Peso Bruto: {peso_bruto}\n')
                            log.write(f'Serviço de Transporte: {servico_transporte}\n')
                            log.write(f'Código do Produto: {codigo_produto}\n')
                            log.write(f'Descrição do Produto: {descricao_produto}\n')
                            log.write(f'Quantidade do Produto: {quantidade_produto}\n')
                            log.write(f'Valor Unitário do Produto: {valor_unitario_produto}\n')
                            log.write(f'Preço de Custo do Produto: {preco_custo_produto}\n')
                            log.write(f'Desconto do Item: {desconto_item}\n')
                            log.write(f'Unidade do Produto: {unidade_produto}\n')
                            log.write(f'Peso Bruto do Produto: {peso_bruto_produto}\n')
                            log.write(f'Largura do Produto: {largura_produto}\n')
                            log.write(f'Altura do Produto: {altura_produto}\n')
                            log.write(f'Profundidade do Produto: {profundidade_produto}\n')

                        # Adiciona o número do pedido à lista de pedidos processados
                        processed_orders.append(numero)

                        print()
                        print()
                        print(numero)


                        #Querys para rodar no SQL
                        # Query Clientes_Pedidos-Consulta
                        query1 = f"""
                            DECLARE @NUMEROCPFCNPJ varchar(14); 
                            SET @NUMEROCPFCNPJ = '{cnpj}'; 

                            DECLARE @IDCPFCNPJ  varchar(50);
                            DECLARE @ACHEI varchar(4);
                            SET @IDCPFCNPJ = (SELECT ID FROM Parceiros WHERE CNPJ = @NUMEROCPFCNPJ)
                            SET @ACHEI = (SELECT COUNT(CNPJ) FROM Parceiros WHERE CNPJ = @NUMEROCPFCNPJ)

                            SELECT
                                CASE WHEN @ACHEI <> 0
                                THEN  'EXECUTADO|ENCONTRADO|'+ @NUMEROCPFCNPJ+'|'+ @IDCPFCNPJ
                                ELSE  'EXECUTADO|NAO_ENCONTRADO|' + @NUMEROCPFCNPJ
                                END AS EXISTE
                            """

                        execute_sql_query(query1)

                        
                        print(Anumerocpfcnpj2) ##NAO FUNCIONA, ESTA RETORNANDO VALOR ZERO (EM BRANCO) ####PRECISA AJUSTAR PARA RODAR A QUERY 5
                        if encontrado_ou_nao == "NAO_ENCONTRADO":
                            #Query Clientes_Pedidos-spParceirosAdd
                            query2 = f"""
                                DECLARE @RESPOSTA varchar(500);

                                DECLARE @NUMEROCPFCNPJ varchar(14); 
                                SET @NUMEROCPFCNPJ = '{cnpj}'; 

                                DECLARE @TEXTO varchar(500);
                                SET @TEXTO ='EXECUTADO|';

                                DECLARE @CODIGO_RETORNO int;
                                SET @CODIGO_RETORNO = 9999;

                                exec @CODIGO_RETORNO = spParceirosAdd 
                                    @ID             = 0, 
                                    @CNPJ           = @NUMEROCPFCNPJ, 
                                    @IE             = '',
                                    @IM             = '',
                                    @PF             = 0,
                                    @Nome           = '{cliente}', 
                                    @Fantasia       = '{cliente} - {tipo_integracao} - {cnpj}', 
                                    @FFantasia      = '{cliente} - {tipo_integracao} - {cnpj}',  
                                    @GrupoEcon      = 1, 
                                    @Segmento       = 1,
                                    @TipoEmpresa    = 0,
                                    @Escrituracao   = 1,
                                    @CRT            = 3,
                                    @MEI            = 0,
                                    @Endereco       = 'AV JOSÉ B.DE SIQUEIRA', 
                                    @Numero         = ' 5C', 
                                    @Complto        = ' AO LADO 1572', 
                                    @Bairro         = 'PADROEIRA', 
                                    @CEP            = '06172000', 
                                    @Cidade         = '3873', 
                                    @DDI1           = '55', 
                                    @DDD1           = '11', 
                                    @Fone1          = '42243223', 
                                    @DDI2           = '',
                                    @DDD2           = '',
                                    @Fone2          = '',
                                    @DDI3           = '',
                                    @DDD3           = '',
                                    @Fone3          = '',
                                    @DDIf           = '',
                                    @DDDf           = '',
                                    @Fonef          = '',
                                    @DDIr           = '',
                                    @DDDr           = '',
                                    @Foner          = '',
                                    @Radior         = '',
                                    @cEndereco      = 'AV JOSÉ B.DE SIQUEIRA', 
                                    @cNumero        = ' 5C', 
                                    @cComplto       = ' AO LADO 1572', 
                                    @cBairro        = 'PADROEIRA', 
                                    @cCEP           = '06172000', 
                                    @cCidade        = '3873', 
                                    @cDDI1          = '55', 
                                    @cDDD1          = '11', 
                                    @cFone1         = '42243223', 
                                    @cDDI2          = '',
                                    @cDDD2          = '11',
                                    @cFone2         = '42243223',
                                    @cDDI3          = '',
                                    @cDDD3          = '',
                                    @cFone3         = '',
                                    @cDDIf          = '',
                                    @cDDDf          = '',
                                    @cFonef         = '',
                                    @cDDIr          = '',
                                    @cDDDr          = '',
                                    @cFoner         = '',
                                    @cRadior        = '',
                                    @eEndereco      = 'AV JOSÉ B.DE SIQUEIRA', 
                                    @eNumero        = ' 5C', 
                                    @eComplto       = ' AO LADO 1572', 
                                    @eBairro        = 'PADROEIRA', 
                                    @eCEP           = '06172000', 
                                    @eCidade        = '3873', 
                                    @eDDI1          = '', 
                                    @eDDD1          = '', 
                                    @eFone1         = '', 
                                    @eDDI2          = '',
                                    @eDDD2          = '',
                                    @eFone2         = '',
                                    @eDDI3          = '',
                                    @eDDD3          = '',
                                    @eFone3         = '',
                                    @eDDIf          = '',
                                    @eDDDf          = '',
                                    @eFonef         = '',
                                    @eDDIr          = '',
                                    @eDDDr          = '',
                                    @eFoner         = '',
                                    @eRadior        = '',
                                    @Revisar        = 0,
                                    @Desde          = '',
                                    @EMail          = 'mpdualvet@gmail.com',
                                    @WebSite        = '',
                                    @Observacao     = '',
                                    @CODEAN         = '',
                                    @SUFRAMA        = '',
                                    @CNAE           = '',
                                    @Cliente        = 1,
                                    @Fornecedor     = 0,
                                    @Empresa        = 0,
                                    @Gerente        = 0,
                                    @Supervisor     = 0,
                                    @Vendedor       = 0,
                                    @Funcionario    = 0,
                                    @Transportadora = 0,
                                    @Loja           = 0,
                                    @PreCadastro    = 0,
                                    @Inativo        = 0,
                                    @Nivel          = 0,
                                    @cstCMF_ICMS    = 0,
                                    @cstCMF_IPI     = 0,
                                    @cstCMF_PIS     = 0,
                                    @cstCMF_COFINS  = 0,
                                    @cstCMF_ST      = 0,
                                    @cstCMFPIS      = 0,
                                    @cstCMFCOFINS   = 0,
                                    @cstCMO_ICMS    = 0,
                                    @cstCMO_IPI     = 0,
                                    @cstCMO_PIS     = 0,
                                    @cstCMO_COFINS  = 0,
                                    @cstCMO_ST      = 0,
                                    @cstCMOPIS      = 0,
                                    @cstCMOCOFINS   = 0,
                                    @TokenIBPT      = '',
                                    @PISCompra      = '',
                                    @COFINSCompra   = '',
                                    @NMostrarPL     = '',
                                    @pComissaoOutros =  '',
                                    @pComissaoVenda  =  '',
                                    @pCME            = '',
                                    @Filiacao        = '',
                                    @RHBancoHoras    = '',
                                    @RHHoraExtra     = '',
                                    @RHHoraFaltas    = '',
                                    @Saida           = @RESPOSTA output;
                                ;
                                SELECT CONCAT(@TEXTO,@NUMEROCPFCNPJ,'|',@RESPOSTA,'|', @CODIGO_RETORNO) AS RESPOSTA;



                                """

                            execute_sql_query2(query2)

                            #Query Pedidos_spParceirosClientesAdd
                            query4 = f"""
                                DECLARE @RESPOSTA varchar(500);

                                DECLARE @NUMEROIDERP varchar(500); 
                                SET @NUMEROIDERP = '{Aidcpfcnpj}'; 

                                DECLARE @TEXTO varchar(500);
                                SET @TEXTO ='EXECUTADO|';

                                DECLARE @CODIGO_RETORNO int;
                                SET @CODIGO_RETORNO = 9999;

                                DECLARE @IDPAGTO int;
                                SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'CARTÃO DE CRÉDITO - VENDA') 

                                exec @CODIGO_RETORNO = spParceirosClientesAdd
                                @ID                 = 0, 
                                @Parceiro           = @NUMEROIDERP, 
                                @Projeto            = 1,
                                @Setor              = 9, 
                                @Ramo               = 19, 
                                @Regiao             = 6, 
                                @Meio               = 1, 
                                @StatusParceiro     = 10, 
                                @Transp             = 1, 
                                @Pagto              = @IDPAGTO, 
                                @TPReceb            = 5, 
                                @Lista              = 1, 
                                @Macrozona          = 1, 
                                @TaxaPagto          = 0.0,
                                @TipoFrete          = 0,
                                @DescDupl           = 0.0,
                                @Desconto           = 0.0,
                                @DiasST             = 0,
                                @DiaMesPDV          = 0, 
                                @VIP                = 0,
                                @BancoPref          = '',
                                @Fator1             = 1,
                                @Fator2             = 1,
                                @Fator3             = 1,
                                @Relatorio          = 0,
                                @DiasPref           = '',
                                @DiasSemPagto       = '',
                                @Isento             = 0,
                                @ParcelaMax         = 0.0,
                                @Comissao           = 0.0,
                                @NCBoleto           = 0,
                                @NCFrete            = 0,
                                @EMailNFe           = 'mpdualvet@gmail.com', 
                                @EMailCob           = 'mpdualvet@gmail.com', 
                                @LimiteCredito      = 0.0,
                                @ObsLimiteCredito   = '',
                                @DataConcessao      = '',
                                @ConcedidoPor       = '',
                                @Descontos          = '',
                                @Prioridade         = 0,
                                @NFe                = 0,
                                @PedidoMinimo       = 0.0,
                                @CFinal             = 1, 
                                @CTBPlanoSub        = 0, 
                                @ObsFixaEst         = '',
                                @ObsFixaCob         = '',
                                @TipoContrib        = 0, 
                                @Carteira           = 0,
                                @Terceiro           = 0,
                                @TComissao          = 0.0,
                                @cpdEndereco        = '', 
                                @cpdNumero          = '',
                                @cpdComplto         = '',
                                @cpdBairro          = '',
                                @cpdCEP             = '',
                                @cpdCidade          = 0,  
                                @cpdDDI1            = '',
                                @cpdDDD1            = '',
                                @cpdFone1           = '',
                                @cpdDDI2            = '',
                                @cpdDDD2            = '',
                                @cpdFone2           = '',
                                @cpdDDI3            = '',
                                @cpdDDD3            = '',
                                @cpdFone3           = '',
                                @cpdObservacao      = '',
                                @WebFantasia        = '',
                                @WebObsrvacao       = '',
                                @HorarioEntrega     = '',
                                @PCTM               = 0.0,  
                                @ContaVendedor      = 0, 
                                @ContaSupervisor    = 0,  
                                @ContaGerente       = 0,  
                                @GCComissao         = 0.0,  
                                @SCComissao         = 0.0,  
                                @VCComissao         = 0.0,  
                                @POL301             = 0,  
                                @POL302             = 0,  
                                @POL303             = 0,  
                                @POL304             = 0,  
                                @POL305             = 0,  
                                @PrefixoProd        = '',
                                @Filiacao           = '',
                                @Saida              = @RESPOSTA output;

                                SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|',@RESPOSTA,'|', @CODIGO_RETORNO) AS RESPOSTA;

                                """



                            execute_sql_query4(query4)



                            #Faz a verificação se a data prevista é nula. se for, a @DATA_EntregaAte deve ser igual a {data_saida}. se não for, deve ser igual a {data_prevista}
                            if (data_prevista) == "":
                                #print("entrou")
                                print(tipointegracao)


                                if tipointegracao.lower() == 'shopee':
                                    print("Shopee")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '1'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'CARTÃO DE CRÉDITO - VENDA') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '42243223',  
                                        @EMail              = 'mpdualvet@gmail.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'olist':
                                    #print("olist")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - OLIST') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = 'payer.{cnpj}@olist.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'magalu':
                                    #print("mglu")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = 'payer.{cnpj}@olist.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;
                                    
                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'amazon':
                                    #print("amaz")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - AMAZON') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'viavarejo':
                                    #print("viavar")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;


                                    """

                                    execute_sql_query5(query5)

                                
                            #as mesmas querys, mudando apenas o @DATA_EntregaAte para {data_prevista}
                            else: 

                                if tipointegracao.lower() == 'shopee':
                                    #print("Shopee2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));;
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '1'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'CARTÃO DE CRÉDITO - VENDA') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '42243223',  
                                        @EMail              = 'mpdualvet@gmail.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)



                                elif tipointegracao.lower() == 'olist':
                                    #print("olist2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));;
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - OLIST') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'magalu':
                                    #print("mglu2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;
                                    
                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'amazon':
                                    #print("amaz2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - AMAZON') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'viavarejo':
                                    #print("vvar2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {Anumerocpfcnpj2}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)



                        else:
                            #Query Clientes_Pedidos-spParceirosEdit
                            #print("vai rodar a query cliente-pedidoEDIT")
                            query3 = f"""
                                DECLARE @RESPOSTA varchar(500);

                                DECLARE @NUMEROID  varchar(500);
                                SET @NUMEROID ='{Aidcpfcnpj}'; 

                                DECLARE @NUMEROCPFCNPJ varchar(14); 
                                SET @NUMEROCPFCNPJ = '{cnpj}'; 

                                DECLARE @TEXTO varchar(500);
                                SET @TEXTO ='EXECUTADO|';

                                DECLARE @CODIGO_RETORNO int;
                                SET @CODIGO_RETORNO = 9999;

                                exec @CODIGO_RETORNO = spParceirosEdit  
                                    @ID             = @NUMEROID, 
                                    @CNPJ           = @NUMEROCPFCNPJ, 
                                    @IE             = '',
                                    @IM             = '',
                                    @PF             = 0,
                                    @Nome           = '{cliente}', 
                                    @Fantasia       = '{cliente} - {tipo_integracao} - {cnpj}', 
                                    @FFantasia      = '{cliente} - {tipo_integracao} - {cnpj}', 
                                    @GrupoEcon      = 1, 
                                    @Segmento       = 1,
                                    @TipoEmpresa    = 0,
                                    @Escrituracao   = 1,
                                    @CRT            = 3,
                                    @MEI            = 0,
                                    @Endereco       = '{endereco_cliente}', 
                                    @Numero         = '{numero_cliente}', 
                                    @Complto        = '{complemento_cliente}', 
                                    @Bairro         = '{bairro_cliente}', 
                                    @CEP            = '{cep_cliente}', 
                                    @Cidade         = '3262',  
                                    @DDI1           = '55', 
                                    @DDD1           = '11', 
                                    @Fone1          = '42243223',  
                                    @DDI2           = '',
                                    @DDD2           = '',
                                    @Fone2          = '',
                                    @DDI3           = '',
                                    @DDD3           = '',
                                    @Fone3          = '',
                                    @DDIf           = '',
                                    @DDDf           = '',
                                    @Fonef          = '',
                                    @DDIr           = '',
                                    @DDDr           = '',
                                    @Foner          = '',
                                    @Radior         = '',
                                    @cEndereco      = '{endereco_cliente}', 
                                    @cNumero        = '{numero_cliente}', 
                                    @cComplto       = ' {complemento_cliente}', 
                                    @cBairro        = '{bairro_cliente}', 
                                    @cCEP           = '{cep_cliente}', 
                                    @cCidade        = '3262', 
                                    @cDDI1          = '55', 
                                    @cDDD1          = '11', 
                                    @cFone1         = '42243223', 
                                    @cDDI2          = '',
                                    @cDDD2          = '',
                                    @cFone2         = '',
                                    @cDDI3          = '',
                                    @cDDD3          = '',
                                    @cFone3         = '',
                                    @cDDIf          = '',
                                    @cDDDf          = '',
                                    @cFonef         = '',
                                    @cDDIr          = '',
                                    @cDDDr          = '',
                                    @cFoner         = '',
                                    @cRadior        = '',
                                    @eEndereco      = '{endereco_cliente}', 
                                    @eNumero        = '{numero_cliente}', 
                                    @eComplto       = ' {complemento_cliente}', 
                                    @eBairro        = '{bairro_cliente}', 
                                    @eCEP           = '{cep_cliente}', 
                                    @eCidade        = '3262', 
                                    @eDDI1          = '',
                                    @eDDD1          = '',
                                    @eFone1         = '',
                                    @eDDI2          = '',
                                    @eDDD2          = '',
                                    @eFone2         = '',
                                    @eDDI3          = '',
                                    @eDDD3          = '',
                                    @eFone3         = '',
                                    @eDDIf          = '',
                                    @eDDDf          = '',
                                    @eFonef         = '',
                                    @eDDIr          = '',
                                    @eDDDr          = '',
                                    @eFoner         = '',
                                    @eRadior        = '',
                                    @Revisar        = 0,
                                    @Desde          = '',
                                    @EMail          = 'mpdualvet@gmail.com', 
                                    @WebSite        = '',
                                    @Observacao     = '',
                                    @CODEAN         = '',
                                    @SUFRAMA        = '',
                                    @CNAE           = '',
                                    @Cliente        = 1,
                                    @Fornecedor     = 0,
                                    @Empresa        = 0,
                                    @Gerente        = 0,
                                    @Supervisor     = 0,
                                    @Vendedor       = 0,
                                    @Funcionario    = 0,
                                    @Transportadora = 0,
                                    @Loja           = 0,
                                    @PreCadastro    = 0,
                                    @Inativo        = 0,
                                    @Nivel          = 0,
                                    @cstCMF_ICMS    = 0,
                                    @cstCMF_IPI     = 0,
                                    @cstCMF_PIS     = 0,
                                    @cstCMF_COFINS  = 0,
                                    @cstCMF_ST      = 0,
                                    @cstCMFPIS      = 0,
                                    @cstCMFCOFINS   = 0,
                                    @cstCMO_ICMS    = 0,
                                    @cstCMO_IPI     = 0,
                                    @cstCMO_PIS     = 0,
                                    @cstCMO_COFINS  = 0,
                                    @cstCMO_ST      = 0,
                                    @cstCMOPIS      = 0,
                                    @cstCMOCOFINS   = 0,
                                    @TokenIBPT      = '',
                                    @PISCompra      = '',
                                    @COFINSCompra   = '',
                                    @NMostrarPL     = '',
                                    @pComissaoOutros =  '',
                                    @pComissaoVenda  =  '',
                                    @pCME            = '',
                                    @Filiacao        = '',
                                    @RHBancoHoras    = '',
                                    @RHHoraExtra     = '',
                                    @RHHoraFaltas    = '',
                                    @Saida           = @RESPOSTA output;
                                ;

                                SELECT CONCAT(@TEXTO,@NUMEROID,'|',@NUMEROCPFCNPJ,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;


                                """

                            execute_sql_query3(query3)

                            #Faz a verificação se a data prevista é nula. se for, a @DATA_EntregaAte deve ser igual a {data_saida}. se não for, deve ser igual a {data_prevista}
                            if (data_prevista) == "":
                                #print("entrou")
                                print(tipointegracao)


                                if tipointegracao.lower() == 'shopee':
                                    print("Shopee")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '1'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'CARTÃO DE CRÉDITO - VENDA') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '42243223',  
                                        @EMail              = 'mpdualvet@gmail.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'olist':
                                    #print("olist")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - OLIST') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = 'payer.{cnpj}@olist.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'magalu':
                                    #print("mglu")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = 'payer.{cnpj}@olist.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;
                                    
                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'amazon':
                                    #print("amaz")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - AMAZON') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'viavarejo':
                                    #print("viavar")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;


                                    """

                                    execute_sql_query5(query5)


                            #as mesmas querys, mudando apenas o @DATA_EntregaAte para {data_prevista}
                            else: 

                                if tipointegracao.lower() == 'shopee':
                                    #print("Shopee2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));;
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '1'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'CARTÃO DE CRÉDITO - VENDA') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '42243223',  
                                        @EMail              = 'mpdualvet@gmail.com',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)



                                elif tipointegracao.lower() == 'olist':
                                    #print("olist2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));;
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - OLIST') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'magalu':
                                    #print("mglu2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '4'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;
                                    
                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'amazon':
                                    #print("amaz2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_prevista},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - AMAZON') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)


                                elif tipointegracao.lower() == 'viavarejo':
                                    #print("vvar2")
                                    query5 = f"""
                                        DECLARE @RESPOSTA varchar(500);

                                        DECLARE @NUMEROIDERP varchar(500); 
                                        SET @NUMEROIDERP = {valores_separados[3]}; 

                                        DECLARE @TEXTO varchar(500);
                                        SET @TEXTO ='EXECUTADO|'

                                        DECLARE  @DATA_AGORA datetime;
                                        SET @DATA_AGORA = GETDATE();

                                        DECLARE  @DATA_EntregaDe datetime;
                                        SET @DATA_EntregaDe = (SELECT CONVERT(DATETIME,{data_saida},121));

                                        DECLARE  @DATA_EntregaAte datetime;
                                        SET @DATA_EntregaAte = (SELECT CONVERT(DATETIME,{data_saida},121));
                                        

                                        DECLARE @CODIGO_RETORNO int;
                                        SET @CODIGO_RETORNO = 9999;

                                        DECLARE @NUMERO_TIPOPED int;
                                        SET @NUMERO_TIPOPED = '5'

                                        DECLARE @IDPAGTO int;
                                        SET @IDPAGTO = (SELECT ID FROM Pagtos WHERE Descricao = 'VENDA - MAGALU') 

                                        exec @CODIGO_RETORNO =  spPedidosAdd
                                        @ID                 = 0,  
                                        @Origem             = 0,  
                                        @Grupo              = 0,  
                                        @Tipo               = 8,  
                                        @SubTipo            = 0,  
                                        @Destinatario       = @NUMEROIDERP,  
                                        @Transp             = 1,  
                                        @SemTransp          = 0,  
                                        @Vendedor           = 16471, 
                                        @Lista              = 1,  
                                        @TipoPed            = @NUMERO_TIPOPED,  
                                        @Pagto              = @IDPAGTO, 
                                        @FormaPagto         = 5,  
                                        @Terceiro           = @NUMEROIDERP,  
                                        @Projeto            = 1,  
                                        @indPres            = 3,  
                                        @Situacao           = 1,  
                                        @StatusFollowUp     = 0,  
                                        @PagtoAntec         = 0,  
                                        @CFinal             = 1,  
                                        @PedidoCliente      = '{numero}',  
                                        @Responsavel        = 'MilkofStone',  
                                        @DDI1               = '',  
                                        @DDD1               = '',  
                                        @Fone1              = '',  
                                        @DDIf               = '',  
                                        @DDDF               = '',  
                                        @Fonef              = '{fone_cliente}',  
                                        @EMail              = '{email_cliente}',  
                                        @EntregaDe          = @DATA_EntregaDe,  
                                        @EntregaAte         = @DATA_EntregaAte,  
                                        @Internet           = NULL,
                                        @TipoFrete          = 0,   
                                        @TPReaj             = 0,   
                                        @ReajDataBase       = @DATA_AGORA,  
                                        @Prioridade         = 0,   
                                        @Desconto           = 0,   
                                        @TPDesconto         = 0,   
                                        @Relatorio          = 0,   
                                        @ValFrete           = '',  
                                        @ValSeguro          = '',  
                                        @ValAcess           = '',  
                                        @PercFrete          = '',  
                                        @Quebra             = 0,   
                                        @Bonificacao        = 0,   
                                        @Marketing          = 0,   
                                        @Meta               = '',  
                                        @Funcionario        = '',  
                                        @ACaixa             = 0 ,  
                                        @AQtd               = 0 ,  
                                        @DataLimite         = NULL,  
                                        @Analise            = 0,   
                                        @SubGrupo           = 0,   
                                        @GrupoReceb         = 0,   
                                        @Pickup             = NULL,  
                                        @Chegada            = NULL,  
                                        @Diponibilidade     = NULL,  
                                        @entrega_UFEmbarq   = '',  
                                        @entrega_xLocEmbarq = '',  
                                        @retira_CNPJ        = '',  
                                        @retira_xLgr        = '',  
                                        @retira_nro         = '',  
                                        @retira_xCpl        = '',  
                                        @retira_xBairro     = '',  
                                        @di_nDI             = '',  
                                        @di_dDi             = NULL,  
                                        @di_xLocDesemb      = '',  
                                        @di_UFDesemb        = '',  
                                        @di_dDesemb         = NULL,  
                                        @di_cExportador     = '',  
                                        @ii_vBC             = 0,   
                                        @ii_vDespAdu        = 0,   
                                        @ii_vII             = 0,   
                                        @ii_vIOF            = 0,   
                                        @Comissao           = 0,   
                                        @TComissao          = 0,   
                                        @NCFrete            = 0,   
                                        @GTotal             = 0,   
                                        @CondPagto          = '',  
                                        @Validade           = 0,   
                                        @Equipamento        = '',  
                                        @AssinadoPor        = 0,   
                                        @Usuario            = '',  
                                        @CambioPrev         = 0,   
                                        @CambioData         = @DATA_AGORA,  
                                        @Transp2            = 1,   
                                        @RCO                = 0,   
                                        @Secretaria         = '',  
                                        @Processo           = '',  
                                        @PNumero            = '',  
                                        @Abertura           = NULL,
                                        @Retirada           = NULL,
                                        @Assessor           = NULL,
                                        @Entrega            = NULL,
                                        @Encerramento       = NULL,
                                        @GrupoEx            = '',  
                                        @PedidoEx           = '',  
                                        @dTipoEntrega       = 0,   
                                        @dEntrega           = 0,   
                                        @Carteira           = 0,   
                                        @Referencia         = '',  
                                        @OS                 = '',  
                                        @ClienteRetira      = 0,   
                                        @Cotacao            = 0,   
                                        @propOutros         = 0,   
                                        @propComissao       = 0,   
                                        @propComissaoSup    = 0,   
                                        @propSDiversos      = 0,   
                                        @propSInterface     = 0,   
                                        @propCAgenciamento  = 0,   
                                        @propNoICMS         = 0,   
                                        @propPIS            = 0,   
                                        @propCOFINS         = 0,   
                                        @propCONTRSOCIAL    = 0,   
                                        @propIRPJ           = 0,   
                                        @propIOUTROS        = 0,   
                                        @propfPIS           = 0,   
                                        @propfCOFINS        = 0,   
                                        @propfCONTRSOCIAL   = 0,   
                                        @propfIRPJ          = 0,   
                                        @Operador           = 0,   
                                        @RedespachoDe       = NULL,
                                        @xPed               = '',  
                                        @xNEmp              = '',  
                                        @xCont              = '',  
                                        @SemRetrocesso      = 0,   
                                        @Saida              = @RESPOSTA output;

                                        SELECT CONCAT(@TEXTO,@NUMEROIDERP,'|', @CODIGO_RETORNO,'|',@RESPOSTA) AS RESPOSTA;

                                    """

                                    execute_sql_query5(query5)



                        #Fazer a lógica dependendo da loja
                        #Query Pedido_Pedidos_spPedidosAdd
                        #Essa é uma tentativa de fazer essa query rodar para ambos os lados, ou seja
                        #Caso tenha NAO_ENCONTRADO ou ENCONTRADO como resposta acima, ele deve rodar
                        #essa query abaixo. Fazer isso vai tornar o código mais simples
                        #print(data_saida)
                        



                        #Faz a verificação se a query consulta retorna mais que 3 valores. se retornar, significa que foi encontrado, sendo assim, é só pegar o ultimo valor da consulta para formar o @NUMEROIDERP. 
                        #Caso contrario, precisa pegar o @NUMEROIDERP da query spParceirosAdd
                        
                        #if len(valores_separados) > 2:
                        #    print("entrou")
                        
                            
                            
                        #else:







    


                        #print(tipo_integracao)

    except requests.exceptions.RequestException as e:
            print("Erro de conexão:", e)
            print("Tentando reconectar em 30 segundos...")
            time.sleep(30)  # Espera 30 segundos antes de tentar reconectar
